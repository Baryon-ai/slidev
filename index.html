<!DOCTYPE html>
<html lang="ko" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marp Vertical - 세로 스크롤 프레젠테이션</title>
    <meta name="description" content="GitHub 마크다운을 아름다운 세로 스크롤 프레젠테이션으로 변환하는 모던 웹 애플리케이션. 6가지 Marp 테마, 수식, 코드 강조, GitHub 연동, 반응형, 풀스크린 지원." />
    <meta property="og:title" content="Marp Vertical - 세로 스크롤 프레젠테이션 뷰어" />
    <meta property="og:description" content="GitHub 마크다운을 아름다운 세로 스크롤 프레젠테이션으로 변환하는 모던 웹앱. 6가지 테마, 수식, 코드, GitHub 연동, 반응형, 풀스크린 지원." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://your-domain.com" />
    <meta property="og:image" content="/og-image.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Marp Vertical - 세로 스크롤 프레젠테이션 뷰어" />
    <meta name="twitter:description" content="GitHub 마크다운을 아름다운 세로 스크롤 프레젠테이션으로 변환하는 모던 웹앱. 6가지 테마, 수식, 코드, GitHub 연동, 반응형, 풀스크린 지원." />
    <meta name="twitter:image" content="/og-image.png" />
    
    <!-- Styles -->
    <link rel="stylesheet" href="/src/styles/main.css">
    <link rel="stylesheet" href="/src/styles/themes.css">
    
    <!-- KaTeX -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    
    <!-- Prism.js -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</head>

<body 
    class="h-full bg-gradient-to-br from-slate-50 to-blue-50 font-sans text-gray-900 transition-all duration-300"
    x-data="$store.app"
    x-init="init()"
>
    <!-- Header -->
    <header 
        class="sticky top-0 z-50 bg-white/80 backdrop-blur-lg border-b border-gray-200 shadow-sm" 
        id="header"
        x-show="!isFullscreen"
        x-transition
    >
        <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Title -->
            <div class="text-center py-4">
                <h1 class="text-2xl font-bold text-gray-900 mb-4">
                    <span class="text-brand-600">🎯</span> Marp Vertical
                    <span class="text-gray-600">- 세로 스크롤 프레젠테이션 뷰어</span>
                </h1>
            </div>

            <!-- Controls -->
            <div class="pb-4">
                <div class="flex flex-wrap items-center justify-center gap-4">
                    <!-- Layout Controls -->
                    <div class="inline-flex rounded-lg bg-gray-100 p-1">
                        <button 
                            @click="setLayout('presentation')"
                            :class="currentLayout === 'presentation' ? 'bg-brand-600 text-white' : 'text-gray-600 hover:text-gray-900'"
                            class="px-3 py-2 text-sm font-medium rounded-md transition-all duration-200"
                        >
                            🎭 프레젠테이션
                        </button>
                        <button 
                            @click="setLayout('split')"
                            :class="currentLayout === 'split' ? 'bg-brand-600 text-white' : 'text-gray-600 hover:text-gray-900'"
                            class="px-3 py-2 text-sm font-medium rounded-md transition-all duration-200"
                        >
                            📊 분할 보기
                        </button>
                    </div>

                    <!-- Theme Selector -->
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">🎨</label>
                        <select 
                            x-model="currentTheme" 
                            @change="changeTheme($event.target.value)"
                            class="rounded-md border-gray-300 text-sm focus:border-brand-500 focus:ring-brand-500"
                        >
                            <option value="default">📋 Default</option>
                            <option value="gaia">🌙 Gaia</option>
                            <option value="uncover">📰 Uncover</option>
                            <option value="academic">🎓 Academic</option>
                            <option value="business">💼 Business</option>
                            <option value="nature">🌿 Nature</option>
                        </select>
                    </div>

                    <!-- Navigation Position -->
                    <div class="flex items-center gap-2">
                        <label class="text-sm font-medium text-gray-700">📍</label>
                        <select 
                            x-model="navPosition"
                            @change="changeNavPosition($event.target.value)"
                            class="rounded-md border-gray-300 text-sm focus:border-brand-500 focus:ring-brand-500"
                        >
                            <option value="left">왼쪽</option>
                            <option value="right">오른쪽</option>
                        </select>
                    </div>

                    <!-- Action Buttons -->
                    <button 
                        @click="toggleInput()"
                        class="px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"
                    >
                        ⚙️ 입력창
                    </button>
                    
                    <button 
                        @click="toggleFullscreen()"
                        class="px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"
                    >
                        🖥️ 풀스크린
                    </button>
                    
                    <button 
                        @click="$dispatch('open-modal')"
                        class="px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"
                    >
                        📁 GitHub
                    </button>
                    
                    <button 
                        @click="loadOfficialDemo()"
                        class="px-4 py-2 text-sm font-semibold text-white bg-gradient-to-r from-red-500 to-red-600 rounded-md hover:from-red-600 hover:to-red-700 transition-all"
                    >
                        🎯 공식 데모
                    </button>
                </div>
            </div>

            <!-- Input Area -->
            <div 
                class="transition-all duration-300 overflow-hidden"
                x-show="inputVisible"
                x-transition
            >
                <div class="flex flex-col lg:flex-row gap-4 pb-4">
                    <div class="flex-1">
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            마크다운 입력 (--- 으로 슬라이드 구분)
                        </label>
                        <textarea 
                            x-model="markdownInput"
                            class="w-full h-32 px-3 py-2 text-sm font-mono border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-y"
                            placeholder="# 첫 번째 슬라이드&#10;내용을 입력하세요...&#10;&#10;---&#10;&#10;# 두 번째 슬라이드&#10;더 많은 내용..."
                        ></textarea>
                    </div>
                    <div class="flex flex-col gap-2 lg:w-48">
                        <button 
                            @click="parseMarkdown(markdownInput)"
                            class="w-full px-4 py-2 text-sm font-semibold text-white bg-brand-600 rounded-lg hover:bg-brand-700 transition-colors"
                        >
                            🚀 생성
                        </button>
                        <button 
                            @click="loadSample()"
                            class="w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
                        >
                            📝 샘플
                        </button>
                        <button 
                            @click="clearAll()"
                            class="w-full px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
                        >
                            🗑️ 초기화
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main 
        class="flex-1 flex bg-white rounded-xl shadow-lg overflow-hidden" 
        id="viewer-container"
        :class="isFullscreen ? 'h-screen rounded-none m-0' : 'm-4'"
    >
        <!-- Editor Section -->
        <div 
            class="flex-col bg-gray-50 border-r border-gray-200 w-1/2" 
            x-show="currentLayout === 'split'"
            x-transition
        >
            <div class="bg-gray-100 px-4 py-3 border-b border-gray-200">
                <h3 class="text-sm font-semibold text-gray-900">📝 마크다운 에디터</h3>
            </div>
            <div class="flex-1 p-4">
                <textarea 
                    x-model="markdownInput"
                    class="w-full h-full p-3 text-sm font-mono border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-brand-500"
                ></textarea>
            </div>
        </div>

        <!-- Presentation Section -->
        <div 
            class="flex flex-1 presentation-section" 
            :class="navPosition === 'right' ? 'flex-row-reverse' : ''"
        >
            <!-- Slide Navigation -->
            <div 
                class="w-64 bg-gray-50 overflow-y-auto border-r border-gray-200" 
                id="slide-navigation"
                :class="navPosition === 'right' ? 'border-l border-r-0' : ''"
            >
                <!-- Content will be populated by JavaScript -->
            </div>

            <!-- Slide Viewer -->
            <div class="flex-1 flex flex-col" id="slide-viewer">
                <!-- Content will be populated by JavaScript -->
            </div>
        </div>
    </main>

    <!-- Controls -->
    <div 
        class="fixed bottom-6 right-6 bg-brand-600 text-white px-4 py-2 rounded-full font-semibold text-sm shadow-lg z-50"
        id="page-indicator"
        x-show="slides.length > 0"
        x-text="(currentSlide + 1) + ' / ' + slides.length"
    ></div>

    <div 
        class="fixed bottom-6 left-1/2 transform -translate-x-1/2 flex gap-2 z-50"
        id="slide-controls"
        x-show="slides.length > 0"
    >
        <button 
            @click="previousSlide()"
            class="px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 text-sm shadow-lg transition-colors"
        >
            ← 이전
        </button>
        <button 
            @click="nextSlide()"
            class="px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 text-sm shadow-lg transition-colors"
        >
            다음 →
        </button>
    </div>

    <!-- GitHub Modal -->
    <div 
        x-data="{ open: false }"
        @open-modal.window="open = true"
        @keydown.escape="open = false"
        x-show="open"
        class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4"
        x-transition
    >
        <div 
            @click.away="open = false"
            class="bg-white rounded-xl shadow-2xl max-w-lg w-full"
        >
            <div class="p-6">
                <h3 class="text-lg font-semibold mb-4">GitHub 마크다운 로드</h3>
                <input 
                    x-model="githubUrl"
                    type="text" 
                    placeholder="https://github.com/user/repo/blob/main/file.md"
                    class="w-full px-3 py-2 border rounded-lg mb-4"
                >
                <div class="flex gap-2">
                    <button 
                        @click="loadFromGitHub(githubUrl); open = false"
                        class="flex-1 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700"
                    >
                        로드
                    </button>
                    <button 
                        @click="open = false"
                        class="px-4 py-2 bg-gray-300 rounded-lg hover:bg-gray-400"
                    >
                        취소
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="/src/scripts/main.js"></script>
    <script>
      // 동적 SEO: url 파라미터가 있으면 해당 마크다운의 제목을 SEO에 반영
      (async function() {
        const params = new URLSearchParams(window.location.search);
        const url = params.get('url');
        if (url) {
          // 파일명 추출
          let title = url.split('/').pop().replace(/\.md$/, '');
          // 마크다운 첫 H1 추출 시도
          try {
            const resp = await fetch(url);
            if (resp.ok) {
              const text = await resp.text();
              const h1 = text.match(/^#\s+(.+)$/m);
              if (h1 && h1[1]) title = h1[1];
            }
          } catch(e) {}
          document.title = title + ' - Marp Vertical';
          // SEO meta 동적 변경
          const desc = document.querySelector('meta[name="description"]');
          if (desc) desc.setAttribute('content', title + ' | GitHub 마크다운 프레젠테이션 뷰어');
          const ogt = document.querySelector('meta[property="og:title"]');
          if (ogt) ogt.setAttribute('content', title + ' - Marp Vertical');
          const ogd = document.querySelector('meta[property="og:description"]');
          if (ogd) ogd.setAttribute('content', title + ' | GitHub 마크다운 프레젠테이션 뷰어');
          const twt = document.querySelector('meta[name="twitter:title"]');
          if (twt) twt.setAttribute('content', title + ' - Marp Vertical');
          const twd = document.querySelector('meta[name="twitter:description"]');
          if (twd) twd.setAttribute('content', title + ' | GitHub 마크다운 프레젠테이션 뷰어');
        }
      })();
    </script>
</body>
</html> 